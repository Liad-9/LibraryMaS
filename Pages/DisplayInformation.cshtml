@page
@model WebApplicationTargil2.Pages.DisplayInformationModel
@{
    ViewData["Title"] = "Display Information";
}

<h3>Display Information</h3>

<!-- Book Search Form -->
<form method="post" asp-page-handler="SearchBook">
    <div>
        <label asp-for="searchBook">Search for a book by ID or name:</label>
        <input asp-for="searchBook" />
    </div>
    <button type="submit">Search Book</button>
</form>

@if (!string.IsNullOrEmpty(Model.BookMessage))
{
    <div>@Model.BookMessage</div>
}

@if (Model.Books != null && Model.Books.Any())
{
    <h3>Book Search Results</h3>
    <table>
        <thead>
            <tr>
                <th>ID</th>
                <th>Name</th>
                <th>Author</th>
                <th>Genre</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var book in Model.Books)
            {
                <tr>
                    <td>@book.bookID</td>
                    <td>@book.bookName</td>
                    <td>@book.bookAuthors</td>
                    <td>@book.bookGenre</td>
                </tr>
            }
        </tbody>
    </table>
}
<br />
<br />
<!-- Subscriber Search Form -->
<form method="post" asp-page-handler="SearchSubscriber">
    <div>
        <label asp-for="searchSubscriber">Search for a subscriber by ID or name:</label>
        <input asp-for="searchSubscriber" />
    </div>
    <button type="submit">Search Subscriber</button>
</form>

@if (!string.IsNullOrEmpty(Model.SubscriberMessage))
{
    <div>@Model.SubscriberMessage</div>
}

@if (Model.Subscribers != null && Model.Subscribers.Any())
{
    <h3>Subscriber Search Results</h3>
    <table>
        <thead>
            <tr>
                <th>ID</th>
                <th>First Name</th>
                <th>Last Name</th>
                <th>Books on Loan</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var subscriber in Model.Subscribers)
            {
                <tr>
                    <td>@subscriber.subscriberID</td>
                    <td>@subscriber.firstName</td>
                    <td>@subscriber.lastName</td>
                    <td>
                        @if (subscriber.booksOnLoan != null && subscriber.booksOnLoan.Any())
                        {
                                @foreach (var book in subscriber.booksOnLoan)
                                {
                                <div>
                                    Book Name: @book.bookName <br />
                                    Author: @book.bookAuthors
                                </div>
                                }
                        }
                        else
                        {
                            <span>No books on loan</span>
                        }
                    </td>
                </tr>
            }
        </tbody>
    </table>
}
<br />
<br />
<!-- Genre Search Form -->
<form method="post" asp-page-handler="SearchGenre">
    <div>
        <label asp-for="searchGenre">Search for books by genre:</label>
        <input asp-for="searchGenre" />
    </div>
    <button type="submit">Search Genre</button>
</form>

@if (!string.IsNullOrEmpty(Model.GenreMessage))
{
    <div>@Model.GenreMessage</div>
}

@if (Model.BooksByGenre != null && Model.BooksByGenre.Any())
{
    <h3>Genre Search Results</h3>
    <table>
        <thead>
            <tr>
                <th>ID</th>
                <th>Name</th>
                <th>Author</th>
                <th>Genre</th>
            </tr>
        </thead>
        <tbody>
            @foreach (var book in Model.BooksByGenre)
            {
                <tr>
                    <td>@book.bookID</td>
                    <td>@book.bookName</td>
                    <td>@book.bookAuthors</td>
                    <td>@book.bookGenre</td>
                </tr>
            }
        </tbody>
    </table>
}